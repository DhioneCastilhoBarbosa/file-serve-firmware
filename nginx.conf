server {
    listen 8080;
    server_name _;

    # CORS preflight
    if ($request_method = OPTIONS) {
        add_header Access-Control-Allow-Origin "*" always;
        add_header Access-Control-Allow-Methods "GET,PUT,DELETE,MKCOL,OPTIONS" always;
        add_header Access-Control-Allow-Headers "Content-Type,Authorization,Origin,Accept" always;
        return 204;
    }

    location ^~ /firmware/ {
        root /usr/share/nginx/html;

        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
        add_header Access-Control-Allow-Origin "*" always;

        # Habilite DAV SE e somente se o m√≥dulo existir
        # dav_methods PUT DELETE MKCOL;
        # dav_access user:rw group:rw all:r;

        client_max_body_size 512m;
        client_body_buffer_size 16m;
    }

    # .hex inline
    location ~* ^/firmware/.+\.hex$ {
        root /usr/share/nginx/html;
        default_type text/plain;
        add_header Content-Disposition "inline";
        add_header Access-Control-Allow-Origin "*" always;
    }

    # .bin download
    location ~* ^/firmware/.+\.bin$ {
        root /usr/share/nginx/html;
        default_type application/octet-stream;
        add_header Content-Disposition "attachment";
        add_header Access-Control-Allow-Origin "*" always;
    }

    # .enfs download
    location ~* ^/firmware/.+\.enfs$ {
        root /usr/share/nginx/html;
        default_type application/octet-stream;
        add_header Content-Disposition "attachment";
        add_header Access-Control-Allow-Origin "*" always;
    }
}
